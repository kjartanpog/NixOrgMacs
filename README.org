#+STARTUP: hideblocks
#+TITLE: Nix Organized with Emacs!
#+AUTHOR: Kjartan M√°sson
#+STARTUP: showeverything
#+OPTIONS: toc:2

#+begin_html
<p align="center">
<a href="https://github.com/nixos/nixpkgs"><img src="https://img.shields.io/badge/NixOS-24.05-royalblue.svg?style=for-the-badge&logo=nixos&labelColor=black"></a>

<a href="https://orgmode.org"><img src="https://img.shields.io/badge/Org-literate%20config-seagreen?style=for-the-badge&logo=org&labelColor=black"></a>

<a href="https://www.gnu.org/software/emacs/emacs.html#Releases"><img src="https://img.shields.io/badge/Emacs-30.0-blueviolet.svg?style=for-the-badge&logo=GNU%20Emacs&labelColor=black"></a>
</p>

<h1 align="center">NixOrgMacs</h1>
#+end_html

+ What is this?

  My entire operating system configuration written in a single file.

+ But why?

  Funny, but also a great opportunity to learn Emacs org-mode.

Inspired by [[https://github.com/idlip/d-nix/tree/gol-d][d-nix]]

| Class              | Name        |
|--------------------+-------------|
| ü™ü Window Manager | [[https://www.gnome.org/][Gnome]]       |
| üìù Text Editor    | [[https://www.gnu.org/software/emacs/][Emacs]]       |
| üåê Web Browser    | [[https://www.mozilla.org/en-US/firefox/new/][Firefox]]     |
| üì® Email          | [[https://www.thunderbird.net/en-US/][Thunderbird]] |

* Table of Contents :TOC:
- [[#flake][Flake]]
- [[#systems][Systems]]
  - [[#thinkpad-z13-gen2][Thinkpad Z13 Gen2]]

* Flake

#+begin_src nix :tangle ./NixOS/flake.nix
  #
  # This file is auto-generated from "README.org"
  #
  {
    description = "My NixOS config & more!";

    inputs = {
      nixpkgs.url = "github:nixos/nixpkgs?ref=nixos-unstable";

      home-manager = {
        url = "github:nix-community/home-manager";
        inputs.nixpkgs.follows = "nixpkgs";
      };

      emacs-overlay.url = "github:nix-community/emacs-overlay";

      betterfox = {
        url = "github:yokoffing/Betterfox";
        flake = false;
      };

      firefox-gnome-theme = {
        url = "github:rafaelmardojai/firefox-gnome-theme";
        flake = false;
      };

      firefox-addons = {
        url = "gitlab:rycee/nur-expressions?dir=pkgs/firefox-addons";
        inputs.nixpkgs.follows = "nixpkgs";
      };

      xremap-flake = {
        url = "github:xremap/nix-flake";
      };
    };

    outputs = { self, nixpkgs, nixos-cosmic, ... }@inputs:
      let
        system = "x86_64-linux";
        nixpkgsUnfree = nixpkgs { config.allowUnfree = true; };
        pkgs = nixpkgsUnfree.legacyPackages.${system};
      in
        {
          nixosConfigurations = {
            Z13 = nixpkgs.lib.nixosSystem {
              specialArgs = {inherit inputs;};
              modules = [
                inputs.home-manager.nixosModules.default
                ./hosts/Z13/configuration.nix
                ./overlay.nix
                { nix.registry.nixpkgs.flake = nixpkgs; }
                {
                  nix.settings = {
                    substituters = [
                      "https://cache.nixos.org"
                    ];
                    trusted-public-keys = [
                      "nix-community.cachix.org-1:mB9FSh9qf2dCimDSUo8Zy7bkq5CX+/rkCWyvRCYg3Fs="
                    ];
                  };
                }
              ];
            };
          };
        };
  }
#+end_src


* Systems
** Thinkpad Z13 Gen2
